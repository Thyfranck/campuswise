<%= form_for @book, :html => { :class => 'form-horizontal', :multipart => true } do |f| %>
  <fieldset>
    <legend>
      <%= controller.action_name.capitalize %>
      Book
    </legend>

    <% if @book.errors.any? %>
      <div id="error_explanation" class="alert alert-error">
        <h4>
          Please fill correctly following <%= pluralize(@book.errors.count, "field") %>.
        </h4>
        <ul>
          <% @book.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
          <% end %>
        </ul>
      </div>
    <% end %>
    <div style="width:inherit">Type a keyword related to your books and you will get some quick suggestion, If you don't find your desired book then click on the search button to get more results.</div>
    <br/>
    <%= form_tag search_path, :class => "form-horizontal", :remote => true do %>
      <div class="control-group">
        <div class="controls">
          <%= text_field_tag :value, nil ,:placeholder => "Enter Title, Author or ISBN number", :class => 'text_field search_field' %>
          <%= submit_tag "Search", :name => 'search',:class => "btn btn-primary search_button" %>
        </div>
      </div>
    <% end %>
    <legend>Book Info</legend>
    <div class="control-group">
      <%= f.label :title, :class => 'control-label' %>
      <div class="controls">
        <%= f.text_field :title , :class => 'text_field', :required => true%>
      </div>
    </div>

    <% if @book.remote_image.blank? %>
      <div class="control-group">
        <%= f.label :image, :class => 'control-label' %>
        <div class="controls">
          <%= f.file_field :image, :class => 'text_field uniform' %>
        </div>
      </div>
    <% end %>


    <div class="control-group">
      <div class="controls">
        <div class="hidden_image"  style="<%= "display:none" unless @book.remote_image.present? %>">
          <img alt="image" src="<%= @book.remote_image %>"></img>
          <%= hidden_field_tag :remote_url, @book.remote_image.present? ? @book.remote_image : "" %>
        </div>
      </div>
    </div>

    <div class="control-group">
      <%= f.label :author, :class => 'control-label' %>
      <div class="controls">
        <%= f.text_field :author, :class => 'text_field', :required => true%>
      </div>
    </div>
    <div class="control-group">
      <%= f.label :isbn, "ISBN", :class => 'control-label' %>
      <div class="controls">
        <%= f.text_field :isbn, :class => 'text_field', :required => true%>
      </div>
    </div>
    <div class="control-group">
      <%= f.label :publisher, :class => 'control-label' %>
      <div class="controls">
        <%= f.text_field :publisher, :class => 'text_field', :required => true %>
      </div>
    </div>


    <% unless @book.requested == true or @requested_book == true %>
      <legend>Loan Rates</legend>
      <div class="control-group">
        <h5><%= f.label :loan_daily, "Daily", :class => 'control-label' %></h5>
        <div class="controls">
          <%= f.number_field :loan_daily, :class => 'number_field', :required => true %><div class="number_error" style="color:red"></div>
        </div>
      </div>
      <div class="control-group">
        <%= f.label :loan_weekly, "Weekly", :class => 'control-label' %>
        <div class="controls">
          <%= f.number_field :loan_weekly, :class => 'number_field', :required => true %><div class="number_error" style="color:red"></div>
        </div>
      </div>
      <div class="control-group">
        <%= f.label :loan_monthly, "Monthly", :class => 'control-label' %><div style="color:red"></div>
        <div class="controls">
          <%= f.number_field :loan_monthly, :class => 'number_field', :required => true %><div class="number_error" style="color:red"></div>
        </div>
      </div>
      <div class="control-group">
        <%= f.label :loan_semister, "Full Semester", :class => 'control-label' %>
        <div class="controls">
          <%= f.number_field :loan_semister, :class => 'number_field', :required => true %><div class="number_error" style="color:red"></div>
        </div>
      </div>

      <legend>Availability</legend>
      <div class="control-group">
        <%= f.label :available, :class => 'control-label' %>
        <div class="controls">
          <%= f.check_box :available, :class => 'check_box' %>
        </div>
      </div>
      <div class="control-group">
        <%= f.label :available_from, :class => 'control-label' %>
        <div class="controls">
          <%= f.date_select :available_from, {}, :class => 'span3 selectpicker' %>
        </div>
      </div>
      <div class="control-group">
        <%= f.label :returning_date, "Available Till", :class => 'control-label' %>
        <div class="controls">
          <%= f.date_select :returning_date, {}, :class => 'span3 selectpicker' %>
        </div>
      </div>
    <% else @requested_book == true %>
      <%= f.hidden_field :requested, :value => true %>
    <% end %>

    <div class="form-actions">
      <%= f.submit "Submit", :class => 'btn btn-primary' %>
      <%= link_to t('.cancel', :default => t("helpers.links.cancel")),
        books_path, :class => 'btn' %>
    </div>
  </fieldset>
<% end %>

<style>
  .ui-autocomplete-loading {
    background:url('/assets/ui-anim_basic_16x16.gif') no-repeat right center;
  }
</style>
